lgs_my_map = {1: 1038, 2: 1115, 3: 1193, 4: 1270, 5: 1348, 6: 1425, 7: 1503, 8: 1580, 9: 1658, 10: 1728, 11: 1753, 12: 1779, 13: 1804, 14: 1830, 15: 1855, 16: 1880, 17: 1906, 18: 1931, 19: 1957, 20: 1982, 21: 2008, 22: 2033, 23: 2059, 24: 2084, 25: 2109, 26: 2135, 27: 2160, 28: 2186, 29: 2211, 30: 2237, 31: 2262, 32: 2288, 33: 2313, 34: 2338, 35: 2364, 36: 2389, 37: 2415, 38: 2440, 39: 2466, 40: 2491, 41: 2516, 42: 2542, 43: 2567, 44: 2593, 45: 2618, 46: 2644, 47: 2669, 48: 2695, 49: 2720, 50: 2745, 51: 3701, 52: 3738, 53: 3775, 54: 3812, 55: 3848, 56: 3885, 57: 3922, 58: 3959, 59: 3996, 60: 4033, 61: 4070, 62: 4107, 63: 4144, 64: 4181, 65: 4218, 66: 4255, 67: 4292, 68: 4329, 69: 4365, 70: 4402, 71: 4439, 72: 4476, 73: 4513, 74: 4550, 75: 4587, 76: 4624, 77: 4661, 78: 4698, 79: 4735, 80: 4772, 81: 4809, 82: 4845, 83: 4882, 84: 4919, 85: 4956, 86: 4993, 87: 5030, 88: 5067, 89: 5104, 90: 5141, 91: 5178, 92: 5215, 93: 5252, 94: 5289, 95: 5326, 96: 5362, 97: 5399, 98: 5436, 99: 5473, 100: 5510, 101: 5788, 102: 5827, 103: 5865, 104: 5904, 105: 5942, 106: 5981, 107: 6019, 108: 6058, 109: 6096, 110: 6135, 111: 6174, 112: 6212, 113: 6251, 114: 6289, 115: 6328, 116: 6366, 117: 6405, 118: 6443, 119: 6482, 120: 6520, 121: 6559, 122: 6597, 123: 6636, 124: 6674, 125: 6713, 126: 6752, 127: 6790, 128: 6829, 129: 6867, 130: 6906, 131: 6944, 132: 6983, 133: 7021, 134: 7060, 135: 7098, 136: 7137, 137: 7175, 138: 7214, 139: 7252, 140: 7291, 141: 7330, 142: 7368, 143: 7407, 144: 7445, 145: 7484, 146: 7522, 147: 7561, 148: 7599, 149: 7638, 150: 7676, 151: 7715, 152: 7753, 153: 7792, 154: 7830, 155: 7869, 156: 7907, 157: 7946, 158: 7985, 159: 8023, 160: 8062, 161: 8100, 162: 8139, 163: 8177, 164: 8216, 165: 8254, 166: 8293, 167: 8331, 168: 8370, 169: 8408, 170: 8447, 171: 8485, 172: 8524, 173: 8563, 174: 8601, 175: 8640, 176: 8678, 177: 8717, 178: 8755, 179: 8794, 180: 8832, 181: 8871, 182: 8909, 183: 8948, 184: 8986, 185: 9025, 186: 9063, 187: 9102, 188: 9141, 189: 9179, 190: 9218, 191: 9256, 192: 9295, 193: 9333, 194: 9372, 195: 9410, 196: 9449, 197: 9487, 198: 9526, 199: 9564, 200: 9603, 250: 11529, 300: 13456, 350: 15383, 400: 17309, 450: 19236, 500: 21162, 550: 23089, 600: 25016, 650: 26942, 700: 28869, 750: 30795, 800: 32722, 850: 34649, 900: 36575, 950: 38502, 1000: 40428, 1050: 42355, 1100: 44282, 1150: 46208, 1200: 48135, 1250: 50061, 1300: 51988, 1350: 53915, 1400: 55841, 1450: 57768, 1500: 59694, 1550: 61621, 1600: 63548, 1650: 65474, 1700: 67401, 1750: 69327, 1800: 71254, 1850: 73181, 1900: 75107, 1950: 77034, 2000: 78960}
lgs_sg_map = {1:892,2:939,3:1009,4:1057,5:1105,6:1174,7:1222,8:1270,9:1340,10:1353,11:1401,12:1472,13:1520,14:1570,15:1640,16:1689,17:1737,18:1808,19:2071,20:2180,21:2250,22:2296,23:2366,24:2412,25:2459,26:2528,27:2575,28:2622,29:2691,30:2738,31:2784,32:2854,33:2900,34:2946,35:3016,36:3063,37:3110,38:3596,39:3644,40:3690,41:3760,42:3806,43:3876,44:3922,45:3968,46:4038,47:4084,48:4132,49:4201,50:4361,51:4400,52:4467,53:4507,54:4546,55:4613,56:4652,57:4692,58:4759,59:4798,60:4838,61:4905,62:4944,63:5011,64:5050,65:5090,66:5157,67:5196,68:5236,69:5302,70:5342,71:5377,72:5442,73:5474,74:5507,75:5857,76:5896,77:5936,78:6003,79:6040,80:6072,81:6137,82:6169,83:6234,84:6266,85:6298,86:6363,87:6395,88:6428,89:6493,90:6525,91:6557,92:6622,93:6654,94:6687,95:6751,96:6784,97:6816,98:6881,99:6913,100:6945,101:7010,102:7042,103:7107,104:7139,105:7172,106:7236,107:7269,108:7301,109:7366,110:7398,111:7430,112:7495,113:7527,114:7560,115:7624,116:7657,117:7689,118:7754,119:7786,120:7818,121:7883,122:7915,123:7980,124:8013,125:8045,126:8110,127:8142,128:8174,129:8239,130:8271,131:8304,132:8368,133:8401,134:8433,135:8498,136:8530,137:8562,138:8627,139:8659,140:8692,141:8756,142:8789,143:8853,144:8886,145:8918,146:8983,147:9015,148:9047,149:11411,150:11411,151:11411,152:11411,153:11411,154:11411,155:11411,156:11411,157:11411,158:11411,159:11411,160:11411,161:11411,162:11411,163:11411,164:11411,165:11411,166:11411,167:11411,168:11411,169:11411,170:11411,171:11411,172:11411,173:11411,174:11411,175:11411,176:11411,177:11411,178:11411,179:11411,180:11411,181:11411,182:11411,183:11411,184:11411,185:11411,186:13028,187:13028,188:13028,189:13028,190:13028,191:13028,192:13028,193:13028,194:13028,195:13028,196:13028,197:13028,198:13028,199:13028,200:13028,250:14645,300:17879,350:19496,400:21113,450:24347,500:25964,550:27581,600:30815,650:32432,700:34049,750:37283,800:38900,850:40517,900:43752,950:45369,1000:46986,1050:50219,1100:51836,1150:55070,1200:56687,1250:58304,1300:61538,1350:63155,1400:64773,1450:68007,1500:69624,1550:71241,1600:74475,1650:76092,1700:77709,1750:80943,1800:82560,1850:84177,1900:87411,1950:89028,2000:90645}
lgs_th_map={1:1477, 2:1559, 3:1640, 4:1722, 5:1803, 6:1884, 7:1966, 8:2047, 9:2128, 10:2210, 11:2291, 12:2372, 13:2454, 14:2535, 15:2617, 16:2698, 17:2779, 18:2861, 19:2942, 20:3023, 21:3105, 22:3186, 23:3267, 24:3349, 25:3430, 26:3511, 27:3593, 28:3664, 29:3729, 30:3794, 31:3859, 32:3924, 33:3989, 34:4055, 35:4120, 36:4185, 37:4250, 38:4315, 39:4507, 40:4572, 41:4637, 42:4702, 43:4767, 44:4832, 45:4897, 46:4962, 47:5027, 48:5093, 49:5151, 50:5202, 51:5252, 52:5302, 53:5352, 54:5402, 55:5452, 56:5502, 57:5552, 58:5603, 59:5653, 60:5703, 61:5753, 62:5803, 63:5853, 64:5903, 65:5953, 66:6004, 67:6054, 68:6104, 69:6154, 70:6204, 71:6254, 72:6304, 73:6354, 74:6405, 75:6455, 76:6505, 77:6787, 78:6837, 79:6887, 80:6938, 81:6988, 82:7038, 83:7088, 84:7138, 85:7188, 86:7238, 87:7288, 88:7339, 89:7389, 90:7439, 91:7489, 92:7539, 93:7589, 94:7639, 95:7689, 96:7740, 97:7790, 98:7840, 99:7890, 100:7940, 101:7990, 102:8040, 103:8090, 104:8140, 105:8191, 106:8241, 107:8291, 108:8341, 109:8391, 110:8441, 111:8491, 112:8541, 113:8592, 114:8642, 115:8692, 116:8823, 117:8873, 118:8923, 119:8974, 120:9024, 121:9074, 122:9124, 123:9174, 124:9224, 125:9274, 126:9324, 127:9375, 128:9425, 129:9475, 130:9525, 131:9575, 132:9625, 133:9675, 134:9725, 135:9776, 136:9826, 137:9876, 138:9926, 139:9976, 140:10026, 141:10076, 142:10126, 143:10177, 144:10227, 145:10277, 146:10327, 147:10377, 148:10427, 149:10477, 150:10527, 151:10577, 152:10628, 153:10678, 154:10809, 155:10859, 156:10909, 157:10960, 158:11010, 159:11060, 160:11110, 161:11160, 162:11210, 163:11260, 164:11310, 165:11360, 166:11411, 167:11461, 168:11511, 169:11561, 170:11611, 171:11661, 172:11711, 173:11761, 174:11812, 175:11862, 176:11912, 177:11962, 178:12012, 179:12062, 180:12112, 181:12162, 182:12213, 183:12263, 184:12313, 185:12363, 186:12413, 187:12463, 188:12513, 189:12563, 190:12614, 191:12664, 192:12714, 193:12845, 194:12895, 195:12945, 196:12996, 197:13046, 198:13096, 199:13146, 200:13301, 250:17219, 300:19979, 350:22826, 400:25895, 450:28569, 500:31242, 550:33915, 600:36588, 650:39261, 700:41934, 750:44607, 800:48346, 850:51019, 900:53692, 950:56365, 1000:59039, 1050:61711, 1100:64384, 1150:67058, 1200:71375, 1250:74048, 1300:76721, 1350:79394, 1400:82068, 1450:84741, 1500:87414, 1550:90087, 1600:92760, 1650:95433, 1700:98106, 1750:100780, 1800:103453, 1850:106126, 1900:108799, 1950:111472, 2000:114145}
lgs_ph_map={1:3310,2:3386,3:3462,4:3538,5:3614,6:3690,7:3765,8:3841,9:3917,10:3993,11:4069,12:4145,13:4221,14:4297,15:4373,16:4449,17:4524,18:4600,19:4676,20:4752,21:4828,22:4904,23:4980,24:5056,25:5132,26:5208,27:5283,28:5359,29:5435,30:5511,31:5587,32:5663,33:5739,34:5815,35:5891,36:5967,37:6042,38:6118,39:6194,40:6270,41:6346,42:6422,43:6498,44:6574,45:6650,46:6726,47:6801,48:6877,49:6953,50:7029,51:7105,52:7181,53:7257,54:7333,55:7409,56:7485,57:7560,58:7636,59:7712,60:7788,61:7864,62:7940,63:8016,64:8092,65:8168,66:8244,67:8319,68:8395,69:8471,70:8547,71:8623,72:8699,73:8775,74:8851,75:8927,76:9003,77:9078,78:9154,79:9230,80:9306,81:9382,82:9458,83:9534,84:9610,85:9686,86:9762,87:9837,88:9913,89:9989,90:10065,91:10141,92:10217,93:10293,94:10369,95:10445,96:10521,97:10596,98:10672,99:10748,100:10824,101:10900,102:10976,103:11052,104:11128,105:11204,106:11280,107:11355,108:11431,109:11507,110:11583,111:11659,112:11735,113:11811,114:11887,115:11963,116:12039,117:12114,118:12190,119:12266,120:12342,121:12418,122:12494,123:12570,124:12646,125:12722,126:12798,127:12873,128:12949,129:13025,130:13101,131:13177,132:13253,133:13329,134:13405,135:13481,136:13557,137:13632,138:13708,139:13784,140:13860,141:13936,142:14012,143:14088,144:14164,145:14240,146:14316,147:14391,148:14467,149:14543,150:14619,151:14695,152:14771,153:14847,154:14923,155:14999,156:15075,157:15150,158:15226,159:15302,160:15378,161:15454,162:15530,163:15606,164:15682,165:15758,166:15834,167:15909,168:15985,169:16061,170:16137,171:16213,172:16289,173:16365,174:16441,175:16517,176:16593,177:16668,178:16744,179:16820,180:16896,181:16972,182:17048,183:17124,184:17200,185:17276,186:17352,187:17427,188:17503,189:17579,190:17655,191:17731,192:17807,193:17883,194:17959,195:18035,196:18111,197:18186,198:18262,199:18338,200:18414,250:22209,300:26004,350:29951,400:33746,450:37692,500:41487,550:45434,600:49229,650:53176,700:56971,750:60917,800:64712,850:68659,900:72454,950:76401,1000:80196,1050:99134,1100:103723,1150:108312,1200:112901,1250:117490,1300:122326,1350:126915,1400:131504,1450:136093,1500:140682,1550:145519,1600:150108,1650:154697,1700:159286,1750:163875,1800:168711,1850:173300,1900:177889,1950:182478,2000:187067}
lgs_id_map={1:1212,2:1298,3:1384,4:1470,5:1557,6:1643,7:1729,8:1815,9:1902,10:1988,11:2074,12:2160,13:2247,14:2333,15:2419,16:2505,17:2592,18:2678,19:2764,20:2850,21:2937,22:3023,23:3109,24:3195,25:3282,26:3368,27:3454,28:3540,29:3627,30:3713,31:3799,32:3885,33:3972,34:4058,35:4144,36:4230,37:4317,38:4403,39:4489,40:4575,41:4662,42:4748,43:4834,44:4920,45:5007,46:5093,47:5179,48:5265,49:5352,50:5438,51:5524,52:5610,53:5697,54:5783,55:5869,56:5955,57:6042,58:6128,59:6214,60:6300,61:6387,62:6473,63:6559,64:6645,65:6732,66:6818,67:6904,68:6990,69:7077,70:7163,71:7249,72:7335,73:7422,74:7508,75:7594,76:7680,77:7767,78:7853,79:7939,80:8025,81:8112,82:8198,83:8284,84:8370,85:8457,86:8543,87:8629,88:8715,89:8802,90:8888,91:8974,92:9060,93:9147,94:9233,95:9319,96:9405,97:9492,98:9578,99:9664,100:9750,101:13487,102:13595,103:13703,104:13811,105:13920,106:14028,107:14136,108:14244,109:14352,110:14461,111:14569,112:14677,113:14785,114:14894,115:15002,116:15110,117:15218,118:15326,119:15435,120:15543,121:15651,122:15759,123:15868,124:15976,125:16084,126:16192,127:16300,128:16409,129:16517,130:16625,131:16733,132:16842,133:16950,134:17058,135:17166,136:17274,137:17383,138:17491,139:17599,140:17707,141:17815,142:17924,143:18032,144:18140,145:18248,146:18357,147:18465,148:18573,149:18681,150:18789,151:18898,152:19006,153:19114,154:19222,155:19331,156:19439,157:19547,158:19655,159:19763,160:19872,161:19980,162:20088,163:20196,164:20305,165:20413,166:20521,167:21614,168:21722,169:21830,170:21939,171:22047,172:22155,173:22263,174:22372,175:22480,176:22588,177:22696,178:22804,179:22913,180:23021,181:23129,182:23237,183:23346,184:23454,185:23562,186:23670,187:23778,188:23887,189:23995,190:24103,191:24211,192:24320,193:24428,194:24536,195:24644,196:24752,197:24861,198:24969,199:25077,200:25185,250:32667,300:38295,350:44908,400:51521,450:57149,500:63762,550:70375,600:76004,650:82617,700:89230,750:94858,800:101471,850:108084,900:113712,950:120325,1000:125953,1050:132566,1100:139179,1150:144807,1200:151420,1250:158033,1300:163661,1350:170274,1400:176887,1450:182516,1500:189129,1550:195742,1600:201370,1650:207983,1700:214596,1750:220224,1800:226837,1850:233450,1900:239078,1950:245691,2000:251319}


def get_lgs_fee(weight, lgs_fee_map=None, country=None):
    # lgs_fee_map can be map dict or country code
    # such as lgs_id_map = {} or "MY"
    if country:
        lgs_fee_map = globals().get('lgs_%s_map' % country.lower(), "lgs_my_map")
    kw = int(float(weight)*100) + 2
    if kw > 200:
        kw = round(kw/100)*100
        if float(weight) > 2:
            kw += 50
    lgs_fee = lgs_fee_map.get(kw, 188888)
    return lgs_fee/100


def get_special_price(origin_price, weight,  base=22.5, country='MY', level='CB'):
    origin_price = float(origin_price)
    lgs_fee_map = globals().get('lgs_%s_map' % country.lower(), "lgs_my_map")
    lgs_fee = get_lgs_fee(weight, lgs_fee_map)
    if country == 'ID':
        lgs_fee *= 1.25
    e_rate = {'MY': 1, 'SG': 0.35,
              'PH': 11.5,
              'TH': 8,
              'ID': 3010}.get(country, 15)
    print("exchage rate %s" % e_rate)
    print(level)
    if level == 'pfh':
        x, y = price_level_pfh(origin_price, base)
    elif level == 'CM00':
        print("CM00 rate change directly")
        return round(e_rate*origin_price, 2)
    else:
        print("right")
        x, y = price_level_temp(origin_price, base)
    print(x, y)
    return round(((x*origin_price+y+0.6*lgs_fee)/0.9) * e_rate, 2)


def price_level(origin_price, base):
    if origin_price <= 1:
            x = base
    elif(origin_price > 1 and origin_price <= 5):
            x = 9.1
    elif(origin_price > 5 and origin_price <= 10):
            x = 6.75
    elif(origin_price > 10 and origin_price <= 20):
            x = 5.85
    elif(origin_price > 20):
            x = 5.5
    return x, 2.25


def price_level_pfh(origin_price, base):
    if origin_price <= 1:
            x = 9
    elif(origin_price > 1 and origin_price <= 10):
            x = 6.75
    elif(origin_price > 10 and origin_price <= 20):
            x = 5.85
    elif(origin_price > 20):
            x = 5.5
    return x, 2.25


def price_level_temp(origin_price, base):
    x = 4.5
    if origin_price <= 5:
            y = 6.76
    elif(origin_price > 5 and origin_price <= 20):
            y = 11.25
    elif(origin_price > 20):
            y = 20.25
    return x, y


def get_sale_price(origin_price, discount=0.52):
    return round(origin_price/discount, 2)
